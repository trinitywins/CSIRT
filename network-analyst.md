# Battle Room Scrape

### Network Analyst

1. Snort is an intrustion detection system (IDS) that began as open source but now also has a commercial offering as well. While the commercial offering is available, changes to snort continue to be fed into the open source and freely available version. Snort funcitons by writing rules that tell snort what to do (an action) based on where the traffic is coming from or going to (source and destination IP and port) and then additional components that are specific to what is in the packet itself. Snort also includes a lot of preprocessors that can help dissect specific protocols, which can greatly increast the functionality of the rules. Snort can also keep track of the stat of communications, which allows for things like knowing whether messages have taken place before. Snort also understand directionality, as in to server or to client, based on who originated the request (the client). Snort relies on Snort IDs (SIDs) to differentiate one rule from another. Snort requires that SIDs be unique across all the rules loaded or else the program will fail.

	- Snort rules are constructed in a very consistent way. A Snort rule consists of an action like alert, indicating what the rule expects Snort to do. In addition to alert, snort supports actions including log, pass, drop and reject as well as others. After the action, you indicate the protocol the the source and destination as well as the direction of the traffic. The source and destination are composed of IP addresses and ports in the case of protocols like TCP and UDP which used ports. Otherwise, it would just be source and diestination IP address. So far, we ahve a rule that would look like alert tcp 10.0.0.0/24 80 -> any any which would indicate we want to alert on anything from the 10.0.0.0/24 subnet on port 80 going to any IP address and port. Once we have that starting point, we would need to add additional components to specify details about the packet. Those details would be placed between () and they would need a ; after each rule section to indicate that we are moving on to another set of rule elements that may have multiple parameters.
	
2. Snort provides a very rich capability to drill into the details of a particular packet. All of these elements would be contained in () in the Snort rule. Not only can you provide details associated with the packet to narrow your focus, but you would also provide other, more generic elements. The first would be 'msg:' that would be displayed in the case of an alert. Also, you indicate the sid: to indicate the Snort ID number. You can also indicate a version number with the rule with rev: You will notice that each of these tags includ a : after it, which indicates the start of the parameters associate. One element that can be useful is flow ':' which can allow you to specify to_server or to_client fo rdirectionality of the communication in terms not only of who is talking to whom but also where that conversation started. Snort will also allow you to specify threshold : parameters to determine how quickly frames are arriving. This can help alert on floods or scans.  Along with threshold : you cna specify a count and the number of seconds that can elapse during which the ocunt will matter. As you are creating rules and specifying parameters, keep in mind that you need to separate parameters with a, while different elements of your rule are separated by a ;. When you complete your rule, you have to finish it with a; before you close it with the ).

3 - 12 Bazillion SNORT RULEEESS

13. Like Wireshark, tcpdump is a program that is used to capture packets. Unlike Wireshark, through, tcpdump is a command line program that doesn't require a graphical user interface. You can use tcpdump to capture packets from an SSH session without the need for an entire desktop for a GUI window. This makes it a valuable tool for network, security or system administrators who may not have remote access to the ddesktop but instead, may be getting in using a command line interface. Also like Wireshar, tcpdump can support capture filters, which you would specify on the command line. If you only wanted to capture traffic to or from a particular IP address, you could use host ipaddr as your filter, which you would add to the command line you were using to start tcpdump.

	- Most systems will have at least two interfaces. On a Linux system, you will have the loopback interface (ofen some variation on lo) and then the network interface that you use to get to the netowrk or to the Internet. tcpdump will default to the primary interface on the system to capture traffic on if you do not specify. depending on how the system is configured and how many interfaces there are, you may not want to use that interface. In order to capture from a particular interface, you would use the -i switch followed by the name of the interface. This may be something like ens33 or eth0. Using -i and the name of the interface will tell tcpdump to capture everything. As a command line program, what you will see come by is a summary of the header information. If you want to store the capture for analysis offline using a tool like Wireshar, you would use -w filename to tell wireshark to write the capture out to the filename you specify.
	
14. Bro is a network security monitor that has a lot of capabilities to help with traffic analysis. While network security monitors typically will monitor real time so they can alert in real time for anything that has been detected, bro can take a packet capture file as a file to read and apply different scripts against to identify malicious activity or just provide usage statistics based on the traffic seen.

	- All netowrk communicaiton happens in a stack, meaning that data is handed from one process or function to another as it makes its way toward delivery, whether that's delivery to the netowrk or delivery to the applicaiton waiting for the data. When a program like tcp dump or Wireshark is used to capture traffic, it inserts itself into the middle of this  stack. As a result, it may not necessarily have all the header information intact. Because of this, you will often see invalid checksums on packed captures that were done on an endpoint, rather than one just sitting passively in the middle of the network stream. The checksums have not been computed and placed into the frame when it is extracted for capture bro is on of those programs that is particular about checksums. As a result, you need to add the -C to get bro to ignore the checksums. However, bro is picky so you have to do it in the correct order. You need to specify the file you are reading first with the -r switch then the filename and finally, you add the -C.
